﻿// This file was auto-generated by ML.NET Model Builder. 
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using Microsoft.ML.Data;
using Microsoft.ML.Trainers.FastTree;
using Microsoft.ML.Trainers;
using Microsoft.ML;

namespace Detection
{
    public partial class DetectionMachineLearning
    {
        public static ITransformer RetrainPipeline(MLContext context, IDataView trainData)
        {
            var pipeline = BuildPipeline(context);
            var model = pipeline.Fit(trainData);

            return model;
        }

        /// <summary>
        /// build the pipeline that is used from model builder. Use this function to retrain model.
        /// </summary>
        /// <param name="mlContext"></param>
        /// <returns></returns>
        public static IEstimator<ITransformer> BuildPipeline(MLContext mlContext)
        {
            // Data process configuration with pipeline data transformations
            var pipeline = mlContext.Transforms.ReplaceMissingValues(new []{new InputOutputColumnPair(@"-1_2", @"-1_2"),new InputOutputColumnPair(@"-1_3", @"-1_3"),new InputOutputColumnPair(@"-1_4", @"-1_4"),new InputOutputColumnPair(@"-1_5", @"-1_5"),new InputOutputColumnPair(@"-1_6", @"-1_6"),new InputOutputColumnPair(@"-1_7", @"-1_7"),new InputOutputColumnPair(@"-1_8", @"-1_8"),new InputOutputColumnPair(@"-1_9", @"-1_9"),new InputOutputColumnPair(@"-1_10", @"-1_10"),new InputOutputColumnPair(@"-1_11", @"-1_11"),new InputOutputColumnPair(@"-1_12", @"-1_12"),new InputOutputColumnPair(@"-1_13", @"-1_13"),new InputOutputColumnPair(@"-1_14", @"-1_14"),new InputOutputColumnPair(@"-1_15", @"-1_15"),new InputOutputColumnPair(@"-1_16", @"-1_16"),new InputOutputColumnPair(@"-1_17", @"-1_17"),new InputOutputColumnPair(@"-1_18", @"-1_18"),new InputOutputColumnPair(@"-1_19", @"-1_19"),new InputOutputColumnPair(@"-1_20", @"-1_20"),new InputOutputColumnPair(@"-1_21", @"-1_21"),new InputOutputColumnPair(@"-1_22", @"-1_22"),new InputOutputColumnPair(@"-1_23", @"-1_23"),new InputOutputColumnPair(@"-1_24", @"-1_24"),new InputOutputColumnPair(@"-1_25", @"-1_25"),new InputOutputColumnPair(@"-1_26", @"-1_26"),new InputOutputColumnPair(@"-1_27", @"-1_27"),new InputOutputColumnPair(@"-1_28", @"-1_28"),new InputOutputColumnPair(@"-1_29", @"-1_29"),new InputOutputColumnPair(@"-1_30", @"-1_30"),new InputOutputColumnPair(@"-1_31", @"-1_31"),new InputOutputColumnPair(@"-1_32", @"-1_32"),new InputOutputColumnPair(@"-1_33", @"-1_33"),new InputOutputColumnPair(@"-1_34", @"-1_34"),new InputOutputColumnPair(@"-1_35", @"-1_35"),new InputOutputColumnPair(@"-1_36", @"-1_36"),new InputOutputColumnPair(@"-1_37", @"-1_37"),new InputOutputColumnPair(@"-1_38", @"-1_38"),new InputOutputColumnPair(@"-1_39", @"-1_39"),new InputOutputColumnPair(@"-1_40", @"-1_40"),new InputOutputColumnPair(@"-1_41", @"-1_41"),new InputOutputColumnPair(@"-1_42", @"-1_42"),new InputOutputColumnPair(@"-1_43", @"-1_43"),new InputOutputColumnPair(@"-1_44", @"-1_44"),new InputOutputColumnPair(@"-1_45", @"-1_45"),new InputOutputColumnPair(@"-1_46", @"-1_46"),new InputOutputColumnPair(@"-1_47", @"-1_47"),new InputOutputColumnPair(@"-1_48", @"-1_48"),new InputOutputColumnPair(@"-1_49", @"-1_49"),new InputOutputColumnPair(@"-1_50", @"-1_50"),new InputOutputColumnPair(@"-1_51", @"-1_51"),new InputOutputColumnPair(@"-1_52", @"-1_52"),new InputOutputColumnPair(@"-1_53", @"-1_53"),new InputOutputColumnPair(@"-1_54", @"-1_54"),new InputOutputColumnPair(@"-1_55", @"-1_55"),new InputOutputColumnPair(@"-1_56", @"-1_56"),new InputOutputColumnPair(@"-1_57", @"-1_57"),new InputOutputColumnPair(@"-1_58", @"-1_58"),new InputOutputColumnPair(@"-1_59", @"-1_59"),new InputOutputColumnPair(@"-1_60", @"-1_60"),new InputOutputColumnPair(@"-1_61", @"-1_61"),new InputOutputColumnPair(@"-1_62", @"-1_62"),new InputOutputColumnPair(@"-1_63", @"-1_63"),new InputOutputColumnPair(@"-1_64", @"-1_64"),new InputOutputColumnPair(@"-1_65", @"-1_65"),new InputOutputColumnPair(@"-1_66", @"-1_66"),new InputOutputColumnPair(@"-1_67", @"-1_67"),new InputOutputColumnPair(@"-1_68", @"-1_68"),new InputOutputColumnPair(@"-1_69", @"-1_69"),new InputOutputColumnPair(@"-1_70", @"-1_70"),new InputOutputColumnPair(@"-1_71", @"-1_71"),new InputOutputColumnPair(@"-1_72", @"-1_72"),new InputOutputColumnPair(@"-1_73", @"-1_73"),new InputOutputColumnPair(@"-1_74", @"-1_74"),new InputOutputColumnPair(@"-1_75", @"-1_75"),new InputOutputColumnPair(@"-1_76", @"-1_76"),new InputOutputColumnPair(@"-1_77", @"-1_77"),new InputOutputColumnPair(@"-1_78", @"-1_78"),new InputOutputColumnPair(@"-1_79", @"-1_79"),new InputOutputColumnPair(@"-1_80", @"-1_80"),new InputOutputColumnPair(@"-1_81", @"-1_81"),new InputOutputColumnPair(@"-1_82", @"-1_82"),new InputOutputColumnPair(@"-1_83", @"-1_83"),new InputOutputColumnPair(@"-1_84", @"-1_84"),new InputOutputColumnPair(@"-1_85", @"-1_85"),new InputOutputColumnPair(@"-1_86", @"-1_86"),new InputOutputColumnPair(@"-1_87", @"-1_87"),new InputOutputColumnPair(@"-1_88", @"-1_88"),new InputOutputColumnPair(@"-1_89", @"-1_89"),new InputOutputColumnPair(@"-1_90", @"-1_90"),new InputOutputColumnPair(@"-1_91", @"-1_91"),new InputOutputColumnPair(@"-1_92", @"-1_92"),new InputOutputColumnPair(@"-1_93", @"-1_93"),new InputOutputColumnPair(@"-1_94", @"-1_94"),new InputOutputColumnPair(@"-1_95", @"-1_95"),new InputOutputColumnPair(@"-1_96", @"-1_96"),new InputOutputColumnPair(@"-1_97", @"-1_97"),new InputOutputColumnPair(@"-1_98", @"-1_98"),new InputOutputColumnPair(@"-1_99", @"-1_99"),new InputOutputColumnPair(@"-1_100", @"-1_100"),new InputOutputColumnPair(@"-1_101", @"-1_101")})      
                                    .Append(mlContext.Transforms.Concatenate(@"Features", new []{@"-1_2",@"-1_3",@"-1_4",@"-1_5",@"-1_6",@"-1_7",@"-1_8",@"-1_9",@"-1_10",@"-1_11",@"-1_12",@"-1_13",@"-1_14",@"-1_15",@"-1_16",@"-1_17",@"-1_18",@"-1_19",@"-1_20",@"-1_21",@"-1_22",@"-1_23",@"-1_24",@"-1_25",@"-1_26",@"-1_27",@"-1_28",@"-1_29",@"-1_30",@"-1_31",@"-1_32",@"-1_33",@"-1_34",@"-1_35",@"-1_36",@"-1_37",@"-1_38",@"-1_39",@"-1_40",@"-1_41",@"-1_42",@"-1_43",@"-1_44",@"-1_45",@"-1_46",@"-1_47",@"-1_48",@"-1_49",@"-1_50",@"-1_51",@"-1_52",@"-1_53",@"-1_54",@"-1_55",@"-1_56",@"-1_57",@"-1_58",@"-1_59",@"-1_60",@"-1_61",@"-1_62",@"-1_63",@"-1_64",@"-1_65",@"-1_66",@"-1_67",@"-1_68",@"-1_69",@"-1_70",@"-1_71",@"-1_72",@"-1_73",@"-1_74",@"-1_75",@"-1_76",@"-1_77",@"-1_78",@"-1_79",@"-1_80",@"-1_81",@"-1_82",@"-1_83",@"-1_84",@"-1_85",@"-1_86",@"-1_87",@"-1_88",@"-1_89",@"-1_90",@"-1_91",@"-1_92",@"-1_93",@"-1_94",@"-1_95",@"-1_96",@"-1_97",@"-1_98",@"-1_99",@"-1_100",@"-1_101"}))      
                                    .Append(mlContext.Regression.Trainers.FastTree(new FastTreeRegressionTrainer.Options(){NumberOfLeaves=34,MinimumExampleCountPerLeaf=26,NumberOfTrees=139,MaximumBinCountPerFeature=406,LearningRate=0.00586666280773152F,FeatureFraction=0.903762814874714F,LabelColumnName=@"-1",FeatureColumnName=@"Features"}));

            return pipeline;
        }
    }
}
